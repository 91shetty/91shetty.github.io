<!DOCTYPE html>
<html>
    <head> 
        <title> DS4UX | HCDE 598 </title>
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <script src="https://d3js.org/d3.v3.min.js"></script>
        <style>

        .node {
            cursor: pointer;
        }

        .node circle {
            fill: #fff;
            stroke: steelblue;
            stroke-width: 1.5px;
        }

        .node text {
            font-family: sans-serif;
            text-transform: capitalize;
        }

        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 1.5px;
        }

        .axis path,
        .axis line {
        fill: none;
        stroke: #fff;
        shape-rendering: crispEdges;
        }

        .bar {
        fill: steelblue;
        }

        .x.axis path {
        display: none;
        }

        .tick {
        font-size: 16px;
        text-transform: capitalize;
        }
        
        rect {
            /*width: 15px !important;*/
        }
    </style>
    </head>
    <body> 
        <div class="container">
            <ul class="slider">
                <li id="1" > <span class="current"> &nbsp; </span> </li>
                <li id="2" > <span> &nbsp; </span> </li>
                <li id="3" > <span> &nbsp; </span> </li>
                <li id="4" > <span> &nbsp; </span> </li>
                <li id="5" > <span> &nbsp; </span> </li>
                <li id="6" > <span> &nbsp; </span> </li>
                <!--<li id="7" > <span> &nbsp; </span> </li>-->
                <li id="8" > <span> &nbsp; </span> </li>
                <li id="9" > <span> &nbsp; </span> </li>
                <li id="10" > <span> &nbsp; </span> </li>
            </ul>
            <section id="slide-1">
                <div class="section-content center"> 
                    <h1> Rise of Golden State Warriors Basketball Team <h1>
                    <h2> DS4UX | HCDE 598 </h2>
                </div>
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-2">
                <h2> Research Question </h2>
                <div class="section-content">  
                    
                    <h1> Rise of Golden State Warriors Basketball Team </h1>
                    <ul class="inline">
                        <li> how the 4 factor <strong> (Shooting, Rebounding, Free throws, Turnovers) </strong>percentage for the team has improved over the past 10 years? </li>
                        <li> what key aspects of Steph Curry&#39;s game makes him an indispensable resource to the GSW&#39;s team? </li>
                        <li> how key stats of 5 mentioned players (Curry, Barnes, Thompson, Iguodala and Green) have impacted the team&#39;s success? </li>
                    </ul>
                </div>
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-3">
                <h2 class="slide-header"> Motivation </h2>
                <div class="section-content"> 
                    <div class="sub-section">
                        <img src="gsw.png" alt="gsw logo">
                        <ul>
                            <li> 2015 NBA Champions, 2016 Western Conference Champions </li>
                            <li> Beat Chicago Bulls' single season win record of 73 </li>
                            <li> NBA record of 54 regular season home game winning streak </li>
                            <li> broke a 131 year old record in all of major professional sports by winning their first 24 games </li>
                        </ul>
                    </div>
                </div>
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-4">
                <h2 class="slide-header"> Motivation </h2>
                <div class="section-content"> 
                    <div class="sub-section">
                        <img src="stephen_curry.png" alt="stephen curry">
                        <ul>
                            <li> 2015, 2016 League MVP </li>
                            <li> Finished 2015-16 regular season with 402 3-pointers </li>
                            <li> NBA Scoring Champion</li>
                            <li> 7th Player in NBA history to join 50-40-90 club </li>
                        </ul>
                    </div>
                </div>
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-5">
                <h2 class="slide-header"> Data Source </h2>
                <div class="section-content">
                    <div class="sub-section">
                        <img src="images/NBA_logo.png" alt="Stats Nba"/>
                        <ul>
                            <li> <strong> nba.stats.com </strong></li>
                            <li> /stats/teaminfocommon </li>
                            <li> /stats/playercareerstats </li>
                            <li> /stats/commonplayerinfo </li>
                            <li> /stats/commonteamroster </li>
                            <li> /stats/teamdashboardbygeneralsplits </li>
                        </ul>
                    </div> 
                    
                </div> 
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-6">
                <h2 class="slide-header"> Methodology </h2>
                <div class="section-content center"> 
                    <ul class="inline">
                        <li> <strong> Research </strong> </li>
                        <li> <strong> Dump Creation <br> Clean up </strong> </li>
                        <li> <strong> Creation of CSV files </strong></li>
                    </ul>
                </div> 
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <!--<section id="slide-7">
                <h2 class="slide-header"> Findings </h2>
                <svg class="teamBarGraph"> </svg>
                </div> 
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>-->
            <section id="slide-8">
                <h2 class="slide-header"> Findings </h2>
                <svg class="tree"> </svg>
                <svg class="barGraph" id="barGraph"> </svg>
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-9">
                <h2 class="slide-header"> Further Research </h2>
                <div class="section-content center"> 
                    <ul class="">
                        <li> Dig deeper to analyze other stats </li>
                        <li> Analyse the stats of the entire team to find deeper answers </li>
                        <li> Use of other visualisations </li>
                    </ul>
                </div> 
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
            <section id="slide-10">
                <div class="section-content center"> 
                    <h2> Thank You </h2>
                    <p> Questions? </p>
                </div> 
                <footer> HCDE 598 | Vishwas Shetty </footer>
            </section>
        </div>
    </body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    
    <script>
            $(document).ready(function () {
                $(".slider li").click(function() {
                   var slide = "#slide-" + this.id;
                   console.log(slide);
                   var current = $(".current");
                   current.removeClass("current");
                   $(this).find("span").addClass("current");
                   $('html, body').animate({
                        scrollTop: $(slide).offset().top
                   }, 500);
                });
            });
            
            
            var margin = {top: 140, right: 120, bottom: 20, left: 120},
            width = 1400 - margin.right - margin.left,
            height = 300 - margin.top - margin.bottom;
            var ih = 80, iw = 80;
            var i = 0,
            duration = 750,
            root;

            var tree = d3.layout.tree()
                .size([width, height]);

            var diagonal = d3.svg.diagonal()
                .projection(function(d) { 
                    return [d.x, d.y]; 
                });

            var svg = d3.select("body").selectAll(".tree")
                .attr("width", width + margin.right + margin.left)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            d3.json("gsw.json", function(error, gsw) {
                if (error) throw error;

                root = gsw;
                root.x0 = width / 2;
                root.y0 = 0;

                function collapse(d) {
                    if (d.children) {
                        d._children = d.children;
                        d._children.forEach(collapse);
                        d.children = null;
                    }
                }

                root.children.forEach(collapse);
                update(root);
            });

            //d3.select(self.frameElement).style("height", "800px");

            function update(source) {

                // Compute the new tree layout.
                var nodes = tree.nodes(root).reverse(),
                links = tree.links(nodes);

                // Normalize for fixed-depth.
                nodes.forEach(function(d) { 
                    d.y = d.depth * 100; 
                });

                // Update the nodes…
                var node = svg.selectAll("g.node")
                    .data(nodes, function(d) { 
                        return d.id || (d.id = ++i); 
                    });

                // Enter any new nodes at the parent's previous position.
                var nodeEnter = node.enter().append("g")
                    .attr("class", "node")
                    .attr("transform", function(d) { 
                        return "translate(" + source.x0 + "," + source.y0 + ")"; 
                    })
                    .on("click", click);

                nodeEnter.append("svg:image")
                    .attr("xlink:href", function(d) { 
                        // console.log("/images/"+d.img; )
                        // return "/images/"+d.img; 
                        return d.img;
                    })
                    .attr("x", -0.5 * iw)
                    .attr("y", -0.5 * ih)
                    // .attr("x", function(d) {
                    //     return -1 * (128 / (2 * d.level));
                    // })
                    // .attr("y", function(d) {
                    //     return -1 * (128 / (2 * d.level));
                    // })
                    .attr("width", iw)
                    .attr("height", ih)
                    // .attr("width", function(d) {
                    //     return 128 / d.level;
                    // })
                    // .attr("height", function(d) {
                    //     //return 128 / d.level;
                    // });
                    // .attr("r", 1e-6)
                    // .style("fill", function(d) { 
                    //     return d._children ? "lightsteelblue" : "#fff"; 
                    // });

                nodeEnter.append("text")
                    .attr("y", function(d) { 
                        return d.children || d._children ? -1 * ih : 0.5 * ih ; 
                    })
                    .attr("dy", ".5em")
                    //.attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
                    .attr("text-anchor", "middle")
                    .attr("font-size", "16px")
                    // .attr("font-size", function(d) {
                    //     return (20 / d.level) + "px";
                    // })
                    .text(function(d) { 
                        return d.name; 
                    })
                    .style("fill-opacity", 1e-6);

                // Transition nodes to their new position.
                var nodeUpdate = node.transition()
                    .duration(duration)
                    .attr("transform", function(d) { 
                        return "translate(" + d.x + "," + d.y + ")"; 
                    });

                // nodeUpdate.select("circle")
                //     .attr("r", 4.5)
                //     .style("fill", function(d) { 
                //         return d._children ? "lightsteelblue" : "#fff"; 
                //     });

                nodeUpdate.select("text")
                    .style("fill-opacity", 1);

                // Transition exiting nodes to the parent's new position.
                var nodeExit = node.exit().transition()
                    .duration(duration)
                    .attr("transform", function(d) { 
                        return "translate(" + source.x + "," + source.y + ")"; 
                    })
                    .remove();

                // nodeExit.select("circle")
                //     .attr("r", 1e-6);

                nodeExit.select("text")
                    .style("fill-opacity", 1e-6);

                // Update the links…
                var link = svg.selectAll("path.link")
                    .data(links, function(d) { 
                        return d.target.id; 
                    });

                // Enter any new links at the parent's previous position.
                link.enter().insert("path", "g")
                    .attr("class", "link")
                    .attr("d", function(d) {
                        var o = {
                            x: source.x0, 
                            y: source.y0
                        };
                        return diagonal({
                            source: o, 
                            target: o
                        });
                    });

                // Transition links to their new position.
                link.transition()
                    .duration(duration)
                    .attr("d", diagonal);

                // Transition exiting nodes to the parent's new position.
                link.exit().transition()
                    .duration(duration)
                    .attr("d", function(d) {
                        var o = {
                            x: source.x, 
                            y: source.y};
                        return diagonal({
                            source: o, 
                            target: o});
                    })
                    .remove();

                // Stash the old positions for transition.
                nodes.forEach(function(d) {
                    d.x0 = d.x;
                    d.y0 = d.y;
                });
            }

            // Toggle children on click.
            function click(d) {
                var name = d.name;
                name = name.replace(" ", "_");
                console.log(name);
                
                drawGraph(name)
            }
            
            //var margin = {top: 20, right: 20, bottom: 40, left: 40},
            var w = 1000 - 20 - 40;
            var h = 450 - 20 - 40;

            var x0 = d3.scale.ordinal()
                .rangeRoundBands([0, w], 0.1);

            var x1 = d3.scale.ordinal();

            var y = d3.scale.linear()
                .range([h, 0]);

            var color = d3.scale.ordinal()
                .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);
                //.range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b"]);

            var xAxis = d3.svg.axis()
                .scale(x0)
                .orient("bottom");

            var yAxis = d3.svg.axis()
                .scale(y)
                .orient("left")
                .tickFormat(d3.format(".2s"));
                
            var ageNames;
            
            function drawGraph(playerName) {
                var fileName = playerName + ".csv";
                document.getElementById("barGraph").innerHTML = "";
                
                var svg_bar = d3.select("body").selectAll(".barGraph")
                    .attr("width", w + 60)
                    .attr("height", h + 60)
                .append("g")
                    .attr("transform", "translate(50, 10)");
                console.log(fileName);
                d3.csv(fileName, function(error, data) {
                    console.log(data);
                    if (error) throw error;

                    ageNames = d3.keys(data[0]).filter(function(key) { return key !== "stats"; });

                    data.forEach(function(d) {
                        d.ages = ageNames.map(function(name) { return {name: name, value: +d[name]}; });
                    });

                    x0.domain(data.map(function(d) { return d.stats; }));
                    x1.domain(ageNames).rangeRoundBands([0, x0.rangeBand()]);
                    // y.domain([0, d3.max(data, function(d) { return d3.max(d.ages, function(d) { return d.value; }); })]);
                    y.domain([0, 100]);
                    
                    svg_bar.append("g")
                        .attr("class", "x axis")
                        .attr("transform", "translate(0," + h + ")")
                        .call(xAxis)
                        .append("text")
                        // .attr("transform", "rotate(-90)")
                        // .attr("y", 6)
                        .attr("x", w)
                        .attr("dx", "0.5em")
                        .attr("dy", "1.2em")
                        .style("text-anchor", "end")
                        .text("Stats")
                        .style("font-size", "16px");

                    svg_bar.append("g")
                        .attr("class", "y axis")
                        .call(yAxis)
                        .append("text")
                        .attr("transform", "rotate(-90)")
                        .attr("y", 6)
                        .attr("dy", ".71em")
                        .style("text-anchor", "end");
                        // .text("Percentage")
                        // .style("font-size", "16px");

                    var year = svg_bar.selectAll(".year")
                        .data(data)
                        .enter().append("g")
                        .attr("class", "year")
                        .attr("transform", function(d) { return "translate(" + x0(d.stats) + ",0)"; });

                    var bars = year.selectAll("rect")
                        .data(function(d) { return d.ages; })
                        .enter().append("rect")
                        .attr("width", x1.rangeBand())
                        .attr("x", function(d) { return x1(d.name) })
                        .attr("y", h - 1) 
                        .attr("height", 1)
                        //.attr("height", function(d) { return height - y(d.value); })
                        .style("fill", function(d) { return color(d.name); })
                        //.style("margin", "0 5px")
                        ;
                        
                    bars.transition()
                        .duration(1000)
                        .delay(100)
                        .attr("height", function(d) {
                            return h - y(d.value);  //Height minus data value
                        })
                        .attr("y", function(d) { return y(d.value); });
                        
                    
                    });
                    // var legend = svg_bar.selectAll(".legend")
                    //       .data(ageNames.slice().reverse())
                    //     .enter().append("g")
                    //       .attr("class", "legend")
                    //       .attr("transform", function(d, i) { return "translate(0," + i * 25 + ")"; });

                    //   legend.append("rect")
                    //       .attr("x", width - 18)
                    //       .attr("width", 18)
                    //       .attr("height", 18)
                    //       .style("fill", color);

                    //   legend.append("text")
                    //       .attr("x", width - 24)
                    //       .attr("y", 9)
                    //       .attr("dy", ".35em")
                    //       .style("text-anchor", "end")
                    //       .style("text-transform", "capitalize")
                    //       .style("font-size", "16px")
                    //       .text(function(d) { return d; });
                    
            }
            
//             var margin1 = {top: 20, right: 20, bottom: 30, left: 40},
//     width1 = 960 - margin1.left - margin1.right,
//     height1 = 700 - margin1.top - margin1.bottom;

// var x1 = d3.scale.ordinal()
//     .rangeRoundBands([0, width1], .1);

// var x2 = d3.scale.ordinal();

// var y1 = d3.scale.linear()
//     .range([height1, 0]);

// var color1 = d3.scale.ordinal()
//     //.range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);
//     .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56"]);

// var xAxis1 = d3.svg.axis()
//     .scale(x0)
//     .orient("bottom");

// var yAxis1 = d3.svg.axis()
//     .scale(y)
//     .orient("left")
//     .tickFormat(d3.format(".2s"));

// var svg2 = d3.select("body").selectAll(".teamBarGraph")
//     .attr("width", width1 + margin1.left + margin1.right)
//     .attr("height", height1 + margin1.top + margin1.bottom)
//   .append("g")
//     .attr("transform", "translate(" + margin1.left + "," + margin1.top + ")");

// d3.csv("data.csv", function(error, data) {
//   if (error) throw error;

//   var ageNames = d3.keys(data[0]).filter(function(key) { return key !== "year"; });

//   data.forEach(function(d) {
//     d.ages = ageNames.map(function(name) { return {name: name, value: +d[name]}; });
//   });

//   x1.domain(data.map(function(d) { return d.year; }));
//   x2.domain(ageNames).rangeRoundBands([0, x1.rangeBand()]);
//   // y.domain([0, d3.max(data, function(d) { return d3.max(d.ages, function(d) { return d.value; }); })]);
//   y1.domain([10, 60]);
  
//   svg2.append("g")
//       .attr("class", "x axis")
//       .attr("transform", "translate(0," + height1 + ")")
//       .call(xAxis1)
//       .append("text")
//       // .attr("transform", "rotate(-90)")
//       // .attr("y", 6)
//       .attr("x", width1)
//       .attr("dx", "0.5em")
//       .attr("dy", "1.2em")
//       .style("text-anchor", "end")
//       .text("Year")
//       .style("font-size", "16px");

//   svg.append("g")
//       .attr("class", "y axis")
//       .call(yAxis1)
//     .append("text")
//       .attr("transform", "rotate(-90)")
//       .attr("y", 6)
//       .attr("dy", ".71em")
//       .style("text-anchor", "end")
//       .text("Percentage")
//       .style("font-size", "16px");

//   var year1 = svg.selectAll(".year1")
//       .data(data)
//     .enter().append("g")
//       .attr("class", "year1")
//       .attr("transform", function(d) { return "translate(" + x0(d.year) + ",0)"; });

//   var bars1 = year1.selectAll("rect")
//       .data(function(d) { return d.ages; })
//     .enter().append("rect")
//       .attr("width", x2.rangeBand())
//       .attr("x", function(d) { return x2(d.name) + 10; })
//       .attr("y", height1 - 1) 
//       .attr("height", 1)
//       //.attr("height", function(d) { return height - y(d.value); })
//       .style("fill", function(d) { return color1(d.name); })
//       //.style("margin", "0 5px")
//       ;
      
// bars1.transition()
//   .duration(1000)
//   .delay(100)
//   .attr("height", function(d) {
//     return height1 - y(d.value);  //Height minus data value
//   })
//   .attr("y", function(d) { return y(d.value); });

//   var legend = svg.selectAll(".legend")
//       .data(ageNames.slice().reverse())
//     .enter().append("g")
//       .attr("class", "legend")
//       .attr("transform", function(d, i) { return "translate(0," + i * 25 + ")"; });

//   legend.append("rect")
//       .attr("x", width - 18)
//       .attr("width", 18)
//       .attr("height", 18)
//       .style("fill", color);

//   legend.append("text")
//       .attr("x", width - 24)
//       .attr("y", 9)
//       .attr("dy", ".35em")
//       .style("text-anchor", "end")
//       .style("text-transform", "capitalize")
//       .style("font-size", "16px")
//       .text(function(d) { return d; });

// });
    </script>
</html>